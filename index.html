<!DOCTYPE html>
<html>
<head>
  <title>Lesson Manager</title>
  <link rel="apple-touch-icon" href="Swimming Person Icon.PNG">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <style>
    @import url("https://fonts.googleapis.com/css2?family=Nunito:wght@600;700&display=swap");
    @import url("https://unpkg.com/@phosphor-icons/web@2.1.1/src/css/phosphor.css");

    :root {
      --blue: #007bb4;
      --blue-strong: #006694;
      --green: #00833d;
      --surface: #f7fbff;
      --ink: #0b2a3c;
      --muted: #6b7a86;
      --card: #ffffff;
      --shadow: 0 10px 30px rgba(0, 59, 92, 0.12);
      --radius-lg: 18px;
      --nav-height: 74px;
      --content-bottom-pad: calc(var(--nav-height) + 104px);
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      background: radial-gradient(circle at 10% 10%, rgba(0, 123, 180, 0.08), transparent 35%),
                  radial-gradient(circle at 90% 0%, rgba(0, 131, 61, 0.08), transparent 35%),
                  #e9f5ff;
      color: var(--ink);
      font-family: "Nunito", "Arial", "Helvetica", sans-serif;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      padding: 10px;
      padding-bottom: calc(var(--nav-height) + 14px);
      overscroll-behavior-y: contain;
    }

    .app-shell {
      width: min(960px, 100%);
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .top-bar {
      display: flex;
      justify-content: center;
      padding: 8px 10px;
    }

    .date-controls {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: var(--card);
      box-shadow: var(--shadow);
      border-radius: 999px;
      padding: 10px 12px;
    }

    .date-input {
      border: none;
      font-size: 17px;
      font-weight: 700;
      color: var(--ink);
      padding: 8px 10px;
      border-radius: 12px;
      background: #f0f6fb;
      outline: none;
    }

    .icon-btn {
      width: 42px;
      height: 42px;
      border-radius: 50%;
      border: none;
      background: var(--blue);
      color: white;
      font-size: 18px;
      font-weight: 700;
      box-shadow: 0 6px 18px rgba(0, 123, 180, 0.25);
      transition: transform 150ms ease, box-shadow 150ms ease;
    }

    .icon-btn:active { transform: translateY(1px) scale(0.98); }

    .content-card {
      background: var(--card);
      box-shadow: var(--shadow);
      border-radius: var(--radius-lg);
      padding: 14px 12px var(--content-bottom-pad);
      min-height: 60vh;
    }

    /* Shared styles for loaded screens */
    .screen-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 12px;
    }

    .screen-title {
      font-size: 22px;
      font-weight: 800;
      margin: 0;
      color: var(--ink);
    }

    .pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 8px 12px;
      border-radius: 999px;
      background: #eef6fc;
      color: var(--blue);
      font-weight: 700;
      font-size: 13px;
    }

    .cta,
    .ghost {
      width: 100%;
      border: none;
      border-radius: 14px;
      padding: 14px 16px;
      font-size: 16px;
      font-weight: 800;
      cursor: pointer;
      transition: transform 150ms ease, box-shadow 150ms ease, background 150ms ease;
    }

    .cta {
      background: linear-gradient(145deg, var(--blue), var(--blue-strong));
      color: #fff;
      box-shadow: 0 14px 30px rgba(0, 123, 180, 0.35);
    }

    .ghost {
      background: #f0f6fb;
      color: var(--blue-strong);
      border: 1px solid rgba(0, 123, 180, 0.2);
      box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.7);
    }

    .cta:active,
    .ghost:active {
      transform: translateY(1px) scale(0.995);
    }

    .data-table {
      width: 100%;
      border-collapse: collapse;
      background: #f9fcff;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: inset 0 0 0 1px rgba(0, 123, 180, 0.05);
    }

    .data-table th,
    .data-table td {
      padding: 12px 10px;
      text-align: left;
      font-size: 15px;
      border-bottom: 1px solid rgba(0, 123, 180, 0.08);
      vertical-align: middle;
      line-height: 1.24;
    }

    .data-table tr:last-child th,
    .data-table tr:last-child td { border-bottom: none; }

    .badge-new {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 2px 8px;
      font-size: 11px;
      font-weight: 800;
      color: var(--green);
      border: 1px solid rgba(0, 131, 61, 0.2);
      background: rgba(0, 131, 61, 0.08);
      border-radius: 999px;
      letter-spacing: 0.5px;
      text-transform: uppercase;
    }

    .muted { color: var(--muted); }

    .table-wrapper {
      background: linear-gradient(180deg, #f5faff, #f0f6fb);
      border-radius: var(--radius-lg);
      padding: 6px 6px 4px;
      box-shadow: inset 0 0 0 1px rgba(0, 123, 180, 0.05);
      overflow-x: auto;
    }

    .name-text {
      display: block;
      width: 100%;
      max-width: min(360px, 60vw);
      min-width: 0;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      word-break: normal;
    }

    .schedule-table {
      table-layout: auto;
      width: 100%;
    }

    .schedule-table th,
    .schedule-table td {
      overflow: hidden;
    }

    .schedule-table th:nth-child(1),
    .schedule-table td:nth-child(1) {
      width: clamp(56px, 8vw, 72px);
      white-space: nowrap;
    }

    .schedule-table th:nth-child(2),
    .schedule-table td:nth-child(2) {
      width: clamp(52px, 7.5vw, 68px);
      white-space: nowrap;
    }

    .schedule-table th:nth-child(4),
    .schedule-table td:nth-child(4),
    .schedule-table th:nth-child(5),
    .schedule-table td:nth-child(5) {
      width: clamp(52px, 8vw, 66px);
      white-space: nowrap;
    }

    .schedule-table th:nth-child(3),
    .schedule-table td:nth-child(3) {
      min-width: 0;
      width: 100%;
      max-width: min(360px, 60vw);
    }

    .text {
      font-weight: 800;
      color: var(--blue);
      line-height: 1.35;
      white-space: normal;
      word-break: keep-all;
      overflow-wrap: normal;
    }

    .checkIn {
      width: 94px;
      min-width: 94px;
      height: 44px;
      white-space: nowrap;
      font-family: "Nunito", sans-serif;
      font-size: 15px;
      font-weight: 800;
      background: var(--green);
      color: #fff;
      margin: 4px 2px;
      padding: 8px 10px;
      border-radius: 12px;
      border: none;
      box-shadow: 0 12px 22px rgba(0, 131, 61, 0.25);
      transition: transform 120ms ease, box-shadow 120ms ease, background 120ms ease;
      flex: 0 0 auto;
    }

    .checkIn:active { transform: translateY(1px) scale(0.99); }

    .bottom-nav {
      position: fixed;
      left: 50%;
      transform: translateX(-50%);
      bottom: 0;
      width: min(960px, 100%);
      height: var(--nav-height);
      background: var(--card);
      border-radius: 18px 18px 0 0;
      box-shadow: 0 -1px 0 rgba(0, 123, 180, 0.08), 0 -2px 18px rgba(0, 59, 92, 0.12);
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      align-items: center;
      padding: 10px 14px;
      z-index: 20;
      overflow: hidden;
    }

    .nav-btn {
      border: none;
      background: transparent;
      color: var(--muted);
      font-weight: 800;
      font-size: 14px;
      display: grid;
      place-items: center;
      gap: 6px;
      padding: 10px 8px;
      border-radius: 14px;
      transition: background 160ms ease, color 160ms ease, transform 120ms ease;
    }

    .nav-btn span {
      display: block;
    }

    .nav-btn .icon {
      font-size: 18px;
    }

    .nav-btn.active {
      background: #eef6fc;
      color: var(--blue-strong);
    }

    .nav-btn:active { transform: translateY(1px) scale(0.98); }

    .pull-indicator {
      position: fixed;
      top: 10px;
      left: 50%;
      transform: translate(-50%, -120%);
      padding: 8px 12px;
      border-radius: 12px;
      background: rgba(0, 123, 180, 0.92);
      color: #fff;
      font-weight: 800;
      font-size: 14px;
      box-shadow: 0 10px 24px rgba(0, 59, 92, 0.22);
      transition: transform 160ms ease, opacity 160ms ease;
      opacity: 0;
      z-index: 26;
      pointer-events: none;
    }

    body.pull-refresh-ready .pull-indicator {
      transform: translate(-50%, 0);
      opacity: 1;
    }

    .floating-actions {
      position: fixed;
      left: 50%;
      transform: translateX(-50%);
      bottom: calc(var(--nav-height) + 10px);
      width: min(960px, calc(100% - 12px));
      display: flex;
      gap: 10px;
      align-items: center;
      justify-content: center;
      z-index: 25;
      pointer-events: none;
    }

      .floating-actions > * {
        pointer-events: auto;
      }

    .floating-actions .cta,
    .floating-actions .ghost {
      flex: 1 1 0;
      max-width: 260px;
      padding: 12px 14px;
      height: 50px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }

      .actions-cell {
        position: sticky;
        right: 0;
        background: linear-gradient(90deg, rgba(249, 252, 255, 0.82), #f9fcff 30%);
        box-shadow: -6px 0 10px rgba(0, 59, 92, 0.04);
      }

      .action-stack { display: flex; gap: 10px; justify-content: flex-start; align-items: flex-start; }
      .checkin-stack { display: flex; flex-direction: column; gap: 6px; align-items: flex-end; width: 100%; }
      .checkins-cell { position: sticky; right: 94px; background: linear-gradient(90deg, rgba(249,252,255,0.9), #f9fcff 50%); box-shadow: -6px 0 10px rgba(0, 59, 92, 0.04); width: 108px; padding-right: 0; text-align: right; }
    .notes-cell { position: sticky; right: 0; background: linear-gradient(90deg, rgba(249,252,255,0.92), #f9fcff 70%); box-shadow: -6px 0 10px rgba(0, 59, 92, 0.04); width: 96px; padding: 4px 2px 4px 0; text-align: right; }
    .notes-btn { width: 90px; min-width: 90px; height: 44px; flex: 0 0 auto; margin-left: 0; }

    @media (max-width: 520px) {
      body { padding: 10px 6px; }
      .app-shell { gap: 10px; }
      .content-card { padding: 12px 10px calc(var(--nav-height) + 114px); }
      .table-wrapper { padding: 4px 4px 2px; }
      .data-table th, .data-table td { padding: 10px 6px; font-size: 14px; }
      .schedule-table th:nth-child(3), .schedule-table td:nth-child(3) { width: auto; max-width: 64vw; }
      .checkIn { margin: 3px 0; }
      .checkin-stack { gap: 6px; }
      .checkins-cell { right: 96px; }
      .floating-actions { width: calc(100% - 10px); bottom: calc(var(--nav-height) + 8px); gap: 8px; }
      .bottom-nav { width: 100%; border-radius: 16px 16px 0 0; }
    }
  </style>
</head>
  <script src="initialize_access.js"></script>
<body>
  <div class="app-shell">
    <header class="top-bar">
      <div class="date-controls">
        <button class="icon-btn" id="prevDate" aria-label="Previous day">&#8592;</button>
        <input class="date-input" id="dateInput" type="date">
        <button class="icon-btn" id="nextDate" aria-label="Next day">&#8594;</button>
      </div>
    </header>
    <main id="app" class="content-card"><h1 class="muted">Loading...</h1></main>
  </div>
  <div class="pull-indicator" aria-hidden="true">Release to refresh</div>
  <nav class="bottom-nav" aria-label="Primary">
    <button class="nav-btn" data-target="schedule">
      <span class="icon" aria-hidden="true"><i class="ph-fill ph-calendar-check"></i></span>
      <span>Schedule</span>
    </button>
    <button class="nav-btn" data-target="attendance">
      <span class="icon" aria-hidden="true"><i class="ph-fill ph-clipboard-check"></i></span>
      <span>Attendance</span>
    </button>
  </nav>
  <script defer>
    function changeDate(days) {
      const dateField = document.getElementById("dateInput");
      if (!dateField.value) {
        dateField.value = new Date().toISOString().split("T")[0];
      }
      dateField.value = new Date(Date.parse(dateField.value) + days * 864e5)
        .toISOString()
        .split("T")[0];
      dateField.dispatchEvent(new Event("change"));
    }
    document.getElementById("prevDate").addEventListener("click", () => changeDate(-1));
    document.getElementById("nextDate").addEventListener("click", () => changeDate(1));

    // Lightweight pull-to-refresh for touch devices
    let pullStartY = null;
    let pullArmed = false;

    const pullHandler = {
      start(e) {
        if (window.scrollY === 0) {
          pullStartY = e.touches[0].clientY;
          pullArmed = true;
        }
      },
      move(e) {
        if (!pullArmed || pullStartY === null) return;
        const delta = e.touches[0].clientY - pullStartY;
        if (delta > 80) {
          document.body.classList.add("pull-refresh-ready");
        } else {
          document.body.classList.remove("pull-refresh-ready");
        }
      },
      end() {
        if (document.body.classList.contains("pull-refresh-ready")) {
          location.reload();
        }
        document.body.classList.remove("pull-refresh-ready");
        pullStartY = null;
        pullArmed = false;
      }
    };

    window.addEventListener("touchstart", pullHandler.start, { passive: true });
    window.addEventListener("touchmove", pullHandler.move, { passive: true });
    window.addEventListener("touchend", pullHandler.end, { passive: true });
  </script>
  <script src="getdata.js" defer></script>
  <script src="navigation.js" defer></script>
</body>
</html>
